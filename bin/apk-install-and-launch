#!/usr/bin/env bash

require() { hash "$@" || exit 127; }

require adb
require apkanalyzer

if [ -z "$1" ] || [ ! -f "$1" ]; then
  echo "usage: $(basename "$0") <apk>"
  exit 1
fi

PACKAGE=$(apkanalyzer manifest application-id "$1")

# Should add support for a -f switch or something
# adb uninstall "$PACKAGE"
adb install -g -t -r "$1" && adb shell monkey -p "$PACKAGE" -c android.intent.category.LAUNCHER 1
