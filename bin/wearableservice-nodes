#!/usr/bin/env bash

usage() {
  cat <<EOF
Usage: $(basename "$0")

Dumps the state of the NodeService from the Wearable Service.

This script extracts the section of the 'dumpsys wearableservice' output
that deals with the connected nodes (devices) in the Wear OS network.
It shows information about each node, such as its ID, name, and whether
it is the local device.

Options:
  -h, --help  Display this help message and exit

Examples:
  # Show all node service information
  $(basename "$0")
EOF
  exit 0
}

if [[ "$1" == "-h" || "$1" == "--help" ]]; then
  usage
fi

require() { hash "$@" || exit 127; }

require adb

adb exec-out dumpsys activity service WearableService | sed -n '/NodeService/,/######/p'
