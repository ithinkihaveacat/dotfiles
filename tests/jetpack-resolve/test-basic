#!/usr/bin/env bash
#
# Tests for bin/jetpack-resolve

set -u

# Setup paths
SCRIPT_DIR=$(dirname "$0")
ROOT_DIR="$SCRIPT_DIR/../.."
BIN_RESOLVE="$ROOT_DIR/bin/jetpack-resolve"

# Total number of tests
TOTAL_TESTS=5
TEST_NUM=0

echo "1..$TOTAL_TESTS"

run_test() {
  local input="$1"
  local expected="$2"

  TEST_NUM=$((TEST_NUM + 1))

  OUTPUT=$("$BIN_RESOLVE" "$input")

  if [ "$OUTPUT" == "$expected" ]; then
    echo "ok $TEST_NUM - $input -> $expected"
  else
    echo "not ok $TEST_NUM - $input -> $expected"
    echo "# Got: $OUTPUT"
    echo "# Expected: $expected"
  fi
}

run_test "androidx.glance.wear.GlanceWearWidgetService" "androidx.glance.wear:wear"
run_test "androidx.glance.wear.WearWidgetParams" "androidx.glance.wear:wear"
run_test "androidx.compose.remote.creation.compose.layout.RemoteBox" "androidx.compose.remote:remote-creation-compose"
run_test "androidx.wear.compose.remote.material3.RemoteButton" "androidx.wear.compose.remote:remote-material3"
run_test "androidx.glance.wear.WearWidgetDocument" "androidx.glance.wear:wear"
